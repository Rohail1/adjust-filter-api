
# Generated by Django 2.1.7 on 2019-03-05 10:33

import csv
from datetime import datetime
from django.db import migrations
from django.conf import settings
from dashboard.models import Dataset


def import_sample_data(apps, schema_editor):

    with open(settings.BASE_DIR+'/sample_data.csv') as csvfile:
        next(csvfile)
        readCSV = csv.reader(csvfile, delimiter=',')
        for row in readCSV:
            dataset = Dataset()
            dataset.date = datetime.strptime(row[0], "%d.%m.%Y")
            dataset.channel = row[1]
            dataset.country = row[2]
            dataset.os = row[3]
            dataset.impressions = row[4]
            dataset.clicks = row[5]
            dataset.installs = row[6]
            dataset.spend = float(row[7])
            dataset.revenue = float(row[8])
            dataset.save()

class Migration(migrations.Migration):

    dependencies = [
        ('dashboard', '0001_initial'),
    ]
    operations = [
        migrations.RunPython(import_sample_data)
    ]
